@page "/addpost"
@inject HttpClient _httpClient
@inject NavigationManager _uriHelper
@using GWBlazor.Shared
@layout MainLayout

<Header Heading="GWS Articles" SubHeading="Add Post"></Header>

<div class="container">
    <div class="row">
        <div class="col-md-12">
            <div class="editor">
                <input @bind=@Title placeholder="Title" class="form-control" />
                <textarea cols="250" asp-for="Description" class="textarea" placeholder="Place some text here"
                          style="height: 550px; font-size: 14px; line-height: 18px; border: 1px solid #dddddd; border-radius:3px; padding: 10px;"></textarea>
                <button class="btn btn-primary float-right" @onclick="@SavePost">Post</button>
            </div>
        </div>
    </div>
</div>


@code {

    protected string Post { get; set; }
    protected string Title { get; set; }
    [Parameter] public int Id { get; set; }

    public async Task SavePost()
    {
        var newPost = new Post()
        {
            PostID = Id,
            Title = Title,
            Author = "Grant Watson",
            Content = Post,
            Posted = DateTime.Now
        };

        var savedPost = await _httpClient.PostAsJsonAsync<Post>(Urls.AddBlogPost, newPost);

        _uriHelper.NavigateTo($"viewpost/{savedPost}/{Id}");
    }
}
